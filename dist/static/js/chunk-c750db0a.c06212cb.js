(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c750db0a"],{1568:function(e,t,n){"use strict";var i=n("3f08"),a=n.n(i);a.a},3123:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("b775");function a(){return Object(i["a"])({url:"https://www.tuantuanzhan.cn/api/v1/upload/token",method:"get"})}},3137:function(e,t,n){},"3f08":function(e,t,n){},"4e44":function(e,t,n){"use strict";var i=n("64b8"),a=n.n(i);a.a},"64b8":function(e,t,n){},8256:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tinymce-container",class:{fullscreen:e.fullscreen},style:{width:e.containerWidth}},[n("textarea",{staticClass:"tinymce-textarea",attrs:{id:e.tinymceId}}),e._v(" "),n("div",{staticClass:"editor-custom-btn-container"},[n("editorImage",{staticClass:"editor-upload-btn",attrs:{color:"#1890ff"},on:{successCBK:e.imageSuccessCBK}})],1)])},a=[],o=(n("ac6a"),n("c5f6"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"upload-container"},[n("el-button",{style:{background:e.color,borderColor:e.color},attrs:{icon:"el-icon-upload",size:"mini",type:"primary"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("\n    上传图片\n  ")]),e._v(" "),n("el-dialog",{attrs:{visible:e.dialogVisible,"modal-append-to-body":!1,"append-to-body":!0},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("el-upload",{staticClass:"editor-slide-upload",attrs:{data:e.dataObj,multiple:!0,"file-list":e.fileList,"show-file-list":!0,"on-remove":e.handleRemove,"on-success":e.handleSuccess,"before-upload":e.beforeUpload,action:"http://upload-z2.qiniup.com","list-type":"picture-card"}},[n("el-button",{attrs:{size:"small",type:"primary"}},[e._v("\n        点击上传\n      ")])],1),e._v(" "),n("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("\n      取消\n    ")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("\n      确认\n    ")])],1)],1)}),r=[],s=(n("456d"),n("3123")),l={name:"EditorSlideUpload",props:{color:{type:String,default:"#1890ff"}},data:function(){return{dialogVisible:!1,listObj:{},fileList:[],dataObj:{token:""}}},created:function(){this.fetchToken()},methods:{fetchToken:function(){var e=this;return new Promise((function(t,n){Object(s["a"])().then((function(n){var i=n.data;e._data.dataObj.token=i,t(!0)})).catch((function(e){console.log(e),n(!1)}))}))},checkAllSuccess:function(){var e=this;return Object.keys(this.listObj).every((function(t){return e.listObj[t].hasSuccess}))},handleSubmit:function(){var e=this,t=Object.keys(this.listObj).map((function(t){return e.listObj[t]}));this.checkAllSuccess()?(this.$emit("successCBK",t),this.listObj={},this.fileList=[],this.dialogVisible=!1):this.$message("Please wait for all images to be uploaded successfully. If there is a network problem, please refresh the page and upload again!")},handleSuccess:function(e,t){for(var n=t.uid,i=Object.keys(this.listObj),a=0,o=i.length;a<o;a++)if(this.listObj[i[a]].uid===n)return this.listObj[i[a]].url="http://ttz-user-file.qiniu.tuantuanzhan.cn/"+e.key,void(this.listObj[i[a]].hasSuccess=!0)},handleRemove:function(e){for(var t=e.uid,n=Object.keys(this.listObj),i=0,a=n.length;i<a;i++)if(this.listObj[n[i]].uid===t)return void delete this.listObj[n[i]]},beforeUpload:function(e){var t=this,n=window.URL||window.webkitURL,i=e.uid;return this.listObj[i]={},new Promise((function(a,o){var r=new Image;r.src=n.createObjectURL(e),r.onload=function(){t.listObj[i]={hasSuccess:!1,uid:e.uid,width:this.width,height:this.height}},a(!0)}))}}},c=l,u=(n("a970"),n("2877")),m=Object(u["a"])(c,o,r,!1,null,"57665114",null),d=m.exports,h=["advlist anchor autolink autosave code codesample colorpicker colorpicker contextmenu directionality emoticons fullscreen hr image imagetools insertdatetime link lists media nonbreaking noneditable pagebreak paste preview print save searchreplace spellchecker tabfocus table template textcolor textpattern visualblocks visualchars wordcount"],f=h,p=["searchreplace bold italic underline strikethrough alignleft aligncenter alignright outdent indent  blockquote undo redo removeformat subscript superscript code codesample","hr bullist numlist link image charmap preview anchor pagebreak insertdatetime media table emoticons forecolor backcolor fullscreen"],b=p,v=n("2d63"),g=[];function y(){return window.tinymce}var k=function(e,t){var n=document.getElementById(e),i=t||function(){};if(!n){var a=document.createElement("script");a.src=e,a.id=e,document.body.appendChild(a),g.push(i);var o="onload"in a?r:s;o(a)}function r(t){t.onload=function(){this.onerror=this.onload=null;var e,n=Object(v["a"])(g);try{for(n.s();!(e=n.n()).done;){var i=e.value;i(null,t)}}catch(a){n.e(a)}finally{n.f()}g=null},t.onerror=function(){this.onerror=this.onload=null,i(new Error("Failed to load "+e),t)}}function s(e){e.onreadystatechange=function(){if("complete"===this.readyState||"loaded"===this.readyState){this.onreadystatechange=null;var t,n=Object(v["a"])(g);try{for(n.s();!(t=n.n()).done;){var i=t.value;i(null,e)}}catch(a){n.e(a)}finally{n.f()}g=null}}}n&&i&&(y()?i(null,n):g.push(i))},w=k,_="https://cdn.jsdelivr.net/npm/tinymce-all-in-one@4.9.3/tinymce.min.js",F={name:"Tinymce",components:{editorImage:d},props:{id:{type:String,default:function(){return"vue-tinymce-"+ +new Date+(1e3*Math.random()).toFixed(0)}},value:{type:String,default:""},toolbar:{type:Array,required:!1,default:function(){return[]}},menubar:{type:String,default:"file edit insert view format table"},height:{type:[Number,String],required:!1,default:360},width:{type:[Number,String],required:!1,default:"auto"}},data:function(){return{hasChange:!1,hasInit:!1,tinymceId:this.id,fullscreen:!1,languageTypeList:{en:"en",zh:"zh_CN",es:"es_MX",ja:"ja"}}},computed:{containerWidth:function(){var e=this.width;return/^[\d]+(\.[\d]+)?$/.test(e)?"".concat(e,"px"):e}},watch:{value:function(e){var t=this;!this.hasChange&&this.hasInit&&this.$nextTick((function(){return window.tinymce.get(t.tinymceId).setContent(e||"")}))}},mounted:function(){this.init()},activated:function(){window.tinymce&&this.initTinymce()},deactivated:function(){this.destroyTinymce()},destroyed:function(){this.destroyTinymce()},methods:{init:function(){var e=this;w(_,(function(t){t?e.$message.error(t.message):e.initTinymce()}))},initTinymce:function(){var e=this,t=this;window.tinymce.init({selector:"#".concat(this.tinymceId),language:this.languageTypeList["zh"],height:this.height,body_class:"panel-body ",object_resizing:!1,toolbar:this.toolbar.length>0?this.toolbar:b,menubar:this.menubar,plugins:f,end_container_on_empty_block:!0,powerpaste_word_import:"clean",code_dialog_height:450,code_dialog_width:1e3,advlist_bullet_styles:"square",advlist_number_styles:"default",imagetools_cors_hosts:["www.tinymce.com","codepen.io"],default_link_target:"_blank",link_title:!1,nonbreaking_force_tab:!0,init_instance_callback:function(n){t.value&&n.setContent(t.value),t.hasInit=!0,n.on("NodeChange Change KeyUp SetContent",(function(){e.hasChange=!0,e.$emit("input",n.getContent())}))},setup:function(e){e.on("FullscreenStateChanged",(function(e){t.fullscreen=e.state}))}})},destroyTinymce:function(){var e=window.tinymce.get(this.tinymceId);this.fullscreen&&e.execCommand("mceFullScreen"),e&&e.destroy()},setContent:function(e){window.tinymce.get(this.tinymceId).setContent(e)},getContent:function(){window.tinymce.get(this.tinymceId).getContent()},imageSuccessCBK:function(e){var t=this;e.forEach((function(e){window.tinymce.get(t.tinymceId).insertContent('<img class="wscnph" src="'.concat(e.url,'" >'))}))}}},O=F,j=(n("d403"),Object(u["a"])(O,i,a,!1,null,"0a27d97b",null));t["a"]=j.exports},"91e2":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"main-content"},[n("div",{staticClass:"left-container"},[n("el-menu",{staticStyle:{"margin-bottom":"20px"},attrs:{"default-active":"1",mode:"horizontal",router:""}},[n("el-menu-item",{attrs:{index:"1",route:{path:"/activity/fangan/edit/"+e.id}}},[e._v("编辑方案")])],1),e._v(" "),n("el-row",[n("el-form",{ref:"form",attrs:{rules:e.rules,model:e.schemeForm,"label-width":"100px",size:"small"}},[n("el-form-item",{attrs:{label:"方案标题"}},[n("el-input",{model:{value:e.schemeForm.title,callback:function(t){e.$set(e.schemeForm,"title",t)},expression:"schemeForm.title"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"封面图"}},[n("el-upload",{staticClass:"avatar-uploader",attrs:{data:e.dataObj,multiple:!1,action:"http://upload-z2.qiniup.com","show-file-list":!1,"on-success":e.handleSuccess,"on-preview":e.handlePicturePreview,"on-remove":e.handleRemove,"before-upload":e.beforeUpload}},[e.schemeForm.imgUrl?n("img",{staticClass:"avatar",attrs:{src:e.schemeForm.imgUrl}}):n("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),e._v(" "),n("el-dialog",{attrs:{visible:e.dialogVisible,"modal-append-to-body":!1,"append-to-body":!0},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("img",{attrs:{width:"100%",src:e.schemeForm.imgUrl,alt:""}})])],1),e._v(" "),n("el-form-item",{attrs:{label:"banner图片"}},[n("el-upload",{staticClass:"avatar-uploader",attrs:{data:e.dataObj,multiple:!1,action:"http://upload-z2.qiniup.com","show-file-list":!1,"on-success":e.handleSuccess1,"on-preview":e.handlePicturePreview1,"on-remove":e.handleRemove1,"before-upload":e.beforeUpload}},[e.schemeForm.bannerImg?n("img",{staticClass:"avatar1",attrs:{src:e.schemeForm.bannerImg}}):n("i",{staticClass:"el-icon-plus avatar-uploader-icon1"})]),e._v(" "),n("el-dialog",{attrs:{visible:e.dialogVisible1,"modal-append-to-body":!1,"append-to-body":!0},on:{"update:visible":function(t){e.dialogVisible1=t}}},[n("img",{attrs:{width:"100%",src:e.schemeForm.bannerImg,alt:""}})])],1),e._v(" "),n("el-form-item",{attrs:{label:"标签"}},[n("el-select",{staticStyle:{width:"600px"},attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"请选择方案标签"},model:{value:e.schemeForm.label,callback:function(t){e.$set(e.schemeForm,"label",t)},expression:"schemeForm.label"}},e._l(e.labelOptions,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),n("el-form-item",{attrs:{label:"方案介绍"}},[n("Tinymce",{ref:"editor1",attrs:{height:300},model:{value:e.schemeForm.explain,callback:function(t){e.$set(e.schemeForm,"explain",t)},expression:"schemeForm.explain"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"功能亮点"}},[n("Tinymce",{ref:"editor2",attrs:{height:300},model:{value:e.schemeForm.lightSpot,callback:function(t){e.$set(e.schemeForm,"lightSpot",t)},expression:"schemeForm.lightSpot"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"营销玩法"}},[n("Tinymce",{ref:"editor3",attrs:{height:300},model:{value:e.schemeForm.gameplay,callback:function(t){e.$set(e.schemeForm,"gameplay",t)},expression:"schemeForm.gameplay"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"活动类型"}},[n("el-select",{attrs:{placeholder:"请选择活动类型"},model:{value:e.schemeForm.type,callback:function(t){e.$set(e.schemeForm,"type",t)},expression:"schemeForm.type"}},e._l(e.activityTypes,(function(e){return n("el-option",{key:e.key,attrs:{label:e.label,value:e.key}})})),1)],1),e._v(" "),n("el-form-item",{attrs:{label:"活动行业"}},[n("el-select",{attrs:{placeholder:"请选择行业",filterable:"","allow-create":""},model:{value:e.schemeForm.industry,callback:function(t){e.$set(e.schemeForm,"industry",t)},expression:"schemeForm.industry"}},e._l(e.industrys,(function(e,t,i){return n("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),e._v(" "),n("el-form-item",{attrs:{label:"会员门槛"}},[n("el-select",{attrs:{placeholder:"请选择会员等级"},model:{value:e.schemeForm.vipLevel,callback:function(t){e.$set(e.schemeForm,"vipLevel",t)},expression:"schemeForm.vipLevel"}},e._l(e.vipLevels,(function(e){return n("el-option",{key:e.key,attrs:{label:e.label,value:e.key}})})),1)],1),e._v(" "),n("el-form-item",{attrs:{label:"虚拟浏览量"}},[n("el-input",{model:{value:e.schemeForm.browse,callback:function(t){e.$set(e.schemeForm,"browse",t)},expression:"schemeForm.browse"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"虚拟参与量"}},[n("el-input",{model:{value:e.schemeForm.receive,callback:function(t){e.$set(e.schemeForm,"receive",t)},expression:"schemeForm.receive"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"是否推荐"}},[n("el-switch",{attrs:{"active-color":"#13ce66","active-value":1,"inactive-value":"0"},model:{value:e.schemeForm.isRecommend,callback:function(t){e.$set(e.schemeForm,"isRecommend",t)},expression:"schemeForm.isRecommend"}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("修改")]),e._v(" "),n("el-button",{on:{click:e.cancel}},[e._v("取消")])],1)],1)],1)],1)])},a=[],o=(n("28a5"),n("ca41")),r=n("3123"),s=n("8256"),l={title:"",imgUrl:"",bannerImg:"",type:"",industry:"",explain:"",lightSpot:"",gameplay:"",browse:0,receive:0,vipLevel:"",isRecommend:0,label:"",id:""},c={name:"UpdataScheme",components:{Tinymce:s["a"]},data:function(){return{id:"",schemeForm:Object.assign({},l),activityTypes:[{key:1,label:"报名"},{key:2,label:"抽奖"},{key:3,label:"海报"},{key:4,label:"砍价"},{key:5,label:"秒杀"},{key:6,label:"拼团"},{key:7,label:"投票"},{key:8,label:"预约"},{key:9,label:"助力"},{key:10,label:"代金券"},{key:11,label:"折扣券"},{key:12,label:"兑换券"},{key:13,label:"体验券"}],industrys:{1:"教育/培训",2:"丽人/美发",3:"亲子/乐园",4:"运动健身",5:"休闲/玩乐",6:"美容/SPA",7:"嬌纱/摄影",8:"家居/装修",9:"生活服务",10:"餐饮美食",11:"母婴",12:"洗车",13:"服装"},vipLevels:[{key:1,label:"普通会员"}],rules:{title:[{required:!0,message:"请输入方案标题",trigger:"blur"},{min:3,max:50,message:"长度在 3 到 50 个字符",trigger:"blur"}],region:[{required:!0,message:"请选择活动区域",trigger:"change"}],type:[{required:!0,message:"请选择一个活动类型",trigger:"change"}],industry:[{required:!0,message:"请选择一个行业",trigger:"change"}],desc:[{required:!0,message:"请填写方案介绍",trigger:"blur"}],cover:[{required:!0,message:"请上传封面图",trigger:"change"}]},dialogImageUrl:"",dialogVisible:!1,dialogVisible1:!1,labelOptions:[{value:"老带新",label:"老带新"},{value:"裂变",label:"裂变"}],listLoading:!1,dataObj:{token:""}}},created:function(){this.id=this.$route.params&&this.$route.params.id,this.fetchData(),this.fetchToken()},methods:{fetchData:function(){var e=this;this.listLoading=!0,Object(o["c"])(this.id).then((function(t){e.schemeForm=t.data,""!==e.schemeForm.label&&(e.schemeForm.label=e.schemeForm.label.split(",")),e.listLoading=!1}))},onSubmit:function(){var e=this;console.log("submit!"),Object(o["h"])(this.schemeForm).then((function(t){1*t.code==200?(e.$message({message:"编辑方案成功",type:"success"}),setTimeout((function(){e.$router.push({path:"/activity/fangan/index"})}),1500)):e.$message({message:t.msg,type:"error"})}))},beforeUpload:function(e){e.type;var t=e.size/1024/1024<2;return t||this.$message.error("上传头像图片大小不能超过 2MB!"),t},fetchToken:function(){var e=this;return new Promise((function(t,n){Object(r["a"])().then((function(n){var i=n.data;e._data.dataObj.token=i,t(!0)})).catch((function(e){console.log(e),n(!1)}))}))},handleRemove:function(e,t){console.log(e,t)},handleRemove1:function(e,t){console.log(e,t)},handleSuccess:function(e,t){this.schemeForm.imgUrl="http://ttz-user-file.qiniu.tuantuanzhan.cn/"+e.key},handleSuccess1:function(e,t){this.schemeForm.bannerImg="http://ttz-user-file.qiniu.tuantuanzhan.cn/"+e.key},handlePicturePreview:function(){this.dialogVisible=!0},handlePicturePreview1:function(){this.dialogVisible1=!0},cancel:function(){this.$router.push({path:"/activity/fangan/index"})}}},u=c,m=(n("4e44"),n("1568"),n("2877")),d=Object(m["a"])(u,i,a,!1,null,"6ab1764a",null);t["default"]=d.exports},a970:function(e,t,n){"use strict";var i=n("3137"),a=n.n(i);a.a},aa77:function(e,t,n){var i=n("5ca1"),a=n("be13"),o=n("79e5"),r=n("fdef"),s="["+r+"]",l="​",c=RegExp("^"+s+s+"*"),u=RegExp(s+s+"*$"),m=function(e,t,n){var a={},s=o((function(){return!!r[e]()||l[e]()!=l})),c=a[e]=s?t(d):r[e];n&&(a[n]=c),i(i.P+i.F*s,"String",a)},d=m.trim=function(e,t){return e=String(a(e)),1&t&&(e=e.replace(c,"")),2&t&&(e=e.replace(u,"")),e};e.exports=m},c5f6:function(e,t,n){"use strict";var i=n("7726"),a=n("69a8"),o=n("2d95"),r=n("5dbc"),s=n("6a99"),l=n("79e5"),c=n("9093").f,u=n("11e9").f,m=n("86cc").f,d=n("aa77").trim,h="Number",f=i[h],p=f,b=f.prototype,v=o(n("2aeb")(b))==h,g="trim"in String.prototype,y=function(e){var t=s(e,!1);if("string"==typeof t&&t.length>2){t=g?t.trim():d(t,3);var n,i,a,o=t.charCodeAt(0);if(43===o||45===o){if(n=t.charCodeAt(2),88===n||120===n)return NaN}else if(48===o){switch(t.charCodeAt(1)){case 66:case 98:i=2,a=49;break;case 79:case 111:i=8,a=55;break;default:return+t}for(var r,l=t.slice(2),c=0,u=l.length;c<u;c++)if(r=l.charCodeAt(c),r<48||r>a)return NaN;return parseInt(l,i)}}return+t};if(!f(" 0o1")||!f("0b1")||f("+0x1")){f=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof f&&(v?l((function(){b.valueOf.call(n)})):o(n)!=h)?r(new p(y(t)),n,f):y(t)};for(var k,w=n("9e1e")?c(p):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),_=0;w.length>_;_++)a(p,k=w[_])&&!a(f,k)&&m(f,k,u(p,k));f.prototype=b,b.constructor=f,n("2aba")(i,h,f)}},ca41:function(e,t,n){"use strict";n.d(t,"f",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"h",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"g",(function(){return m}));n("ac6a"),n("456d");var i=n("b775");function a(e,t){return Object(i["a"])({url:"/system/management/activity/getSpecialActivity?size="+e.size+"&current="+e.current,method:"post",data:t,headers:{"Content-Type":"application/json"},transformRequest:[function(e,t){for(var n in e)""===e[n]&&delete e[n];return e=JSON.stringify(e),e}]})}function o(e,t){return Object(i["a"])({url:"/system/activity/getActivityScheme?size="+e.size+"&current="+e.current,method:"post",data:t,headers:{"Content-Type":"application/json"},transformRequest:[function(e,t){for(var n in e)""===e[n]&&delete e[n];return e=JSON.stringify(e),e}]})}function r(e){return Object(i["a"])({url:"/system/activity/addActivityScheme",method:"post",data:e,transformRequest:[function(e){console.log(e);var t=Object.keys(e).length,n=0,i="";for(var a in e)i+=encodeURIComponent(a)+"="+encodeURIComponent(e[a]),n<t-1&&(i+="&",n++);return i}],headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function s(e){return Object(i["a"])({url:"/system/activity/getActivitySchemeInfo",method:"get",params:{schemeId:e}})}function l(e){return Object(i["a"])({url:"/system/activity/deleteScheme",method:"delete",params:{schemeId:e}})}function c(e){return Object(i["a"])({url:"/system/activity/updateActivityScheme",method:"post",data:e,transformRequest:[function(e){console.log(e);var t=Object.keys(e).length,n=0,i="";for(var a in e)i+=encodeURIComponent(a)+"="+encodeURIComponent(e[a]),n<t-1&&(i+="&",n++);return i}],headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function u(e,t){return Object(i["a"])({url:"/system/activity/getActivitys",method:"post",params:e,data:t,headers:{"Content-Type":"application/json"},transformRequest:[function(e,t){for(var n in e)""===e[n]&&delete e[n];return e=JSON.stringify(e),e}]})}function m(e){return Object(i["a"])({url:"/system/management/activity/setActivityWithGoodOrRecommend",method:"post",params:e})}},d403:function(e,t,n){"use strict";var i=n("e016"),a=n.n(i);a.a},e016:function(e,t,n){},fdef:function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);